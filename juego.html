<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Juego de Instrumentos</title>
  <style>
    body {
      font-family: 'Poppins', sans-serif;
      background-color: #e6f7f5;
      color: #333;
      text-align: center;
      padding: 20px;
    }
    h1 {
      color: #00796b;
    }
    .game-container {
      margin-top: 20px;
    }
    .options {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-top: 20px;
    }
    .option {
      border: 2px solid #ccc;
      border-radius: 12px;
      padding: 10px;
      cursor: pointer;
      transition: transform 0.2s, border-color 0.2s;
      width: 120px;
      height: 120px;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
      background: white;
    }
    .option img {
      width: 100%;
      height: 100%;
      object-fit: contain;
    }
    .option:hover {
      transform: scale(1.05);
      border-color: #00796b;
    }
    .correct {
      border-color: green !important;
      background-color: #d4edda;
    }
    .wrong {
      border-color: red !important;
      background-color: #f8d7da;
    }
    button {
      padding: 10px 20px;
      margin-top: 20px;
      background-color: #00796b;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 16px;
      transition: background 0.2s;
    }
    button:hover {
      background-color: #004d40;
    }
    .message {
      margin-top: 20px;
      font-weight: bold;
    }
    .question-counter {
      margin-top: 10px;
      font-size: 18px;
      color: #555;
    }
    .warning {
      color: red;
      margin-top: 15px;
      font-weight: bold;
      animation: shake 0.3s;
    }
    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      20%, 60% { transform: translateX(-10px); }
      40%, 80% { transform: translateX(10px); }
    }
    .game-over {
      font-size: 28px;
      font-weight: bold;
      color: #00796b;
      margin-top: 30px;
      background: #ffffff;
      padding: 20px;
      border-radius: 12px;
      display: inline-block;
      box-shadow: 0px 4px 8px rgba(0,0,0,0.2);
    }
  </style>
</head>
<body>
  <h1>🎵 Adivina el Instrumento 🎵</h1>
  <div class="game-container">
    <button id="playBtn">Escuchar</button>
    <div class="options" id="options"></div>
    <p class="question-counter" id="counter"></p>
    <p class="message" id="message"></p>
    <p class="warning" id="warning" style="display:none;"></p>
    <button id="nextBtn" style="display:none;">Siguiente</button>
    <div id="gameOver" class="game-over" style="display:none;"></div>
  </div>

  <script>
    const instruments = [
      { name: "guitarra", sound: "sounds/guitarra.mp3", image: "images/guitarra.jpg" },
      { name: "piano", sound: "sounds/piano.mp3", image: "images/piano.jpg" },
      { name: "violin", sound: "sounds/violin.mp3", image: "images/violin.jpg" },
      { name: "trompeta", sound: "sounds/trompeta.mp3", image: "images/trompeta.jpg" },
      { name: "flauta", sound: "sounds/flauta.mp3", image: "images/flauta.jpg" },
      { name: "bateria", sound: "sounds/bateria.mp3", image: "images/bateria.jpg" },
      { name: "saxofon", sound: "sounds/saxo.mp3", image: "images/saxo.jpg" },
      { name: "acordeon", sound: "sounds/acordeon.mp3", image: "images/acordeon.jpg" },
      { name: "arpa", sound: "sounds/arpa.mp3", image: "images/arpa.jpg" },
      { name: "clarinete", sound: "sounds/clarinete.mp3", image: "images/clarinete.jpg" }
    ];

    let currentQuestion = 0;
    let score = 0;
    let correctInstrument;
    let audio = new Audio();
    let hasListened = false;
    let answered = false;

    const optionsDiv = document.getElementById("options");
    const playBtn = document.getElementById("playBtn");
    const nextBtn = document.getElementById("nextBtn");
    const message = document.getElementById("message");
    const counter = document.getElementById("counter");
    const warning = document.getElementById("warning");
    const gameOverDiv = document.getElementById("gameOver");

    function shuffle(array) {
      return array.sort(() => Math.random() - 0.5);
    }

    function loadQuestion() {
      answered = false;
      hasListened = false;
      warning.style.display = "none";
      message.textContent = "";
      nextBtn.style.display = "none";
      playBtn.textContent = "Escuchar";

      optionsDiv.innerHTML = "";
      let choices = shuffle([...instruments]).slice(0, 3);
      correctInstrument = choices[Math.floor(Math.random() * 3)];

      audio.src = correctInstrument.sound;

      choices.forEach(inst => {
        const option = document.createElement("div");
        option.classList.add("option");
        option.innerHTML = `<img src="${inst.image}" alt="${inst.name}">`;
        option.addEventListener("click", () => selectOption(inst, option));
        optionsDiv.appendChild(option);
      });

      counter.textContent = `Pregunta ${currentQuestion + 1} de 10`;
    }

    function selectOption(inst, option) {
      if (!hasListened) {
        warning.textContent = "Debe escuchar el instrumento primero";
        warning.style.display = "block";
        optionsDiv.classList.add("shake");
        setTimeout(() => optionsDiv.classList.remove("shake"), 300);
        return;
      }
      if (answered) return;
      answered = true;

      if (inst === correctInstrument) {
        option.classList.add("correct");
        message.textContent = "✅ ¡Correcto!";
        score++;
      } else {
        option.classList.add("wrong");
        message.textContent = `❌ Incorrecto. Era: ${correctInstrument.name}`;
        const correctOption = [...optionsDiv.children].find(opt => 
          opt.querySelector("img").alt === correctInstrument.name
        );
        if (correctOption) correctOption.classList.add("correct");
      }
      nextBtn.style.display = "inline-block";
    }

    playBtn.addEventListener("click", () => {
      warning.style.display = "none";
      if (audio.paused) {
        audio.play();
        hasListened = true;
        playBtn.textContent = "Pausar";
      } else {
        audio.pause();
        playBtn.textContent = "Reescuchar";
      }
    });

    nextBtn.addEventListener("click", () => {
      audio.pause();
      currentQuestion++;
      if (currentQuestion < 10) {
        loadQuestion();
      } else {
        showGameOver();
      }
    });

    function showGameOver() {
      optionsDiv.innerHTML = "";
      playBtn.style.display = "none";
      nextBtn.style.display = "none";
      counter.textContent = "";
      message.textContent = "";
      gameOverDiv.style.display = "block";
      gameOverDiv.textContent = `🎉 Juego terminado 🎉\nTu puntuación final fue: ${score}/10`;
    }

    loadQuestion();
  </script>
</body>
</html>
